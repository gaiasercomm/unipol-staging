<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">

<properties>

    <entry key="redis.host">10.243.170.97</entry>
    <entry key="redis.port">6389</entry>
    <entry key="redis.password">I7oQu60OB63d3yC</entry>

	<!-- redis.deploymentModel:
    1: REDIS_DEPLOY_TYPE_SINGLE
    2: REDIS_DEPLOY_TYPE_CLUSTER
    3: REDIS_DEPLOY_TYPE_SENTINEL
    4: REDIS_DEPLOY_TYPE_REPLICATED
    5: REDIS_DEPLOY_TYPE_MASTER_SLAVE
	-->
    <entry key="redis.deploymentModel">1</entry>

    <!-- lua scripts -->
	<entry key="LUA_POLL_FIRST_EXPIRED_KEY"><![CDATA[
        local v = redis.call('zrangebyscore', KEYS[1], ARGV[1], ARGV[2], 'limit', '0', '1');
        if #v > 0 then
        redis.call('zrem', KEYS[1], v[1]);
        return v[1];
        end
        return nil;
        ]]>
    </entry>

    <entry key="LUA_SCAN_KEYS"><![CDATA[
        local cursor = '0';
        local done = false;
        local keys = {};
        local keyValues = {};
        local count = ARGV[1];
        local idx = 0;
        repeat
        local value;
        local result = redis.call('SCAN', cursor, 'MATCH', KEYS[1], 'COUNT', count);
        cursor = result[1];
        keys = result[2];
        count = count - #keys;
        for i, key in ipairs(keys) do
            idx = idx + 1;
            value = redis.call('GET', key);
            keyValues[idx] = value;
        end
        if cursor == '0' or count <= 0 then
        done = true;
        end
        until done
        return keyValues;
        ]]>
    </entry>

    <entry key="LUA_SET_IPDEVICE"><![CDATA[
        return redis.call('set', KEYS[1], ARGV[1], "XX");]]>
    </entry>
    
    <entry key="KEY_NAMESPACE">gaia:</entry>
    
</properties>